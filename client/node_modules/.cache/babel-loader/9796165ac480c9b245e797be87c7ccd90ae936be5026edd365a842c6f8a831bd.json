{"ast":null,"code":"var _jsxFileName = \"/Users/roshanravindran/Downloads/MERN_Login_App_with_ResetEmail-Main/client/src/components/ChatPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport homeIcon from '../assets/home.png';\nimport dalleBot from '../assets/dalle_bot.jpg';\nimport sendButton from '../assets/send_button.png';\nimport styles from '../styles/ChatPage.module.css';\nimport user from '../assets/vt_student.jpg';\nimport { useAuthStore } from '../store/store';\nimport useFetch from '../hooks/fetch.hook';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatPage = () => {\n  _s();\n  const {\n    category\n  } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    prompt\n  } = location.state || {};\n  const [input, setInput] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [messageHistory, setMessageHistory] = useState([]);\n  const [quest, setQuest] = useState('');\n  const studentName = \"Roshan Ravindran\";\n  const [userName, setUserName] = useState('');\n  const [userImage, setUserImage] = useState(user);\n  const {\n    username\n  } = useAuthStore(state => state.auth);\n  const [{\n    isLoading,\n    apiData,\n    serverError\n  }] = useFetch(`/user/${username}`);\n  useEffect(() => {\n    const loadingElement = document.getElementById('loading');\n    setTimeout(() => {\n      if (loadingElement) loadingElement.style.display = 'none';\n    }, 1500);\n    // fetchUserData();\n    // console.log(\"username\" + username)\n    // console.log(apiData?.firstName)\n    // console.log(apiData?.profile)\n\n    if (prompt) {\n      initialChatGPT(prompt);\n      console.log(\"the prompt is\" + prompt);\n    }\n  }, [prompt]);\n  useEffect(() => {\n    console.log(\"Message History Updated:\", messageHistory);\n  }, [messageHistory]);\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const currentChatbot = getChatbotFromPrompt(String(urlParams));\n    const selector = document.getElementById('category-selector');\n    if (selector) {\n      if (currentChatbot) {\n        selector.value = currentChatbot;\n      } else {\n        selector.selectedIndex = 0;\n      }\n    }\n    const prompt_url = urlParams.get('prompt');\n    if (prompt_url) {\n      setQuest(prompt_url);\n    }\n  }, []);\n  useEffect(() => {\n    const categorySelector = document.getElementById(styles.categorySelector);\n    if (categorySelector) {\n      const handleCategoryChange = function () {\n        console.log(\"AFTER \" + this.value);\n        if (this.value) {\n          console.log(\"username\" + username);\n          console.log(apiData === null || apiData === void 0 ? void 0 : apiData.firstName);\n          console.log(apiData === null || apiData === void 0 ? void 0 : apiData.profile);\n          setPromptForCategory(this.value);\n        }\n      };\n      categorySelector.addEventListener('change', handleCategoryChange);\n\n      // Cleanup event listener\n      return () => {\n        categorySelector.removeEventListener('change', handleCategoryChange);\n      };\n    }\n  }, []);\n  // const fetchUserData = async () => {\n  //   try {\n  //     const response = await fetch('http://localhost:8080/api/user'); // Adjust the API endpoint as needed\n  //     const data = await response.json();\n  //     setUserName(data.username);\n  //     setUserImage(data.profilePicture || user);\n  //   } catch (error) {\n  //     console.error('Failed to fetch user data:', error);\n  //   }\n  // };\n\n  const handleHomeClick = () => {\n    showLoading();\n    setTimeout(() => {\n      navigate('/chatbot');\n    }, 1500);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    console.log(\"clicked on the submit button\");\n    if (input.trim() === \"\") {\n      return;\n    }\n    const newMessage = {\n      role: 'user',\n      content: input\n    };\n    console.log(\"input\" + newMessage.role + newMessage.content);\n    setMessages([...messages, newMessage]);\n    setMessageHistory([...messageHistory, newMessage]);\n    setInput('');\n    await handleChatGPT(input);\n  };\n  const handleChatGPT = async message => {\n    const uniqueId = generateUniqueId();\n    const newMessage = {\n      role: 'assistant',\n      content: 'Loading...',\n      id: uniqueId\n    };\n    setMessages(prevMessages => [...prevMessages, newMessage]);\n    messageHistory.concat([{\n      role: 'user',\n      content: message\n    }]);\n    const response = await sendMessageToChatGPT(messageHistory.concat([{\n      role: 'user',\n      content: message\n    }]));\n    setMessages(prevMessages => {\n      const updatedMessages = [...prevMessages];\n      const index = updatedMessages.findIndex(msg => msg.id === uniqueId);\n      if (index !== -1) {\n        updatedMessages[index].content = '';\n        typeText(document.getElementById(uniqueId), response, () => handleYesNoButtons(response, uniqueId));\n      }\n      return updatedMessages;\n    });\n    setMessageHistory(prevHistory => [...prevHistory, {\n      role: 'assistant',\n      content: response\n    }]);\n  };\n  const initialChatGPT = async initialPrompt => {\n    setQuest(initialPrompt);\n    const initialMessage = {\n      role: 'system',\n      content: initialPrompt\n    };\n    setMessages([{\n      role: 'assistant',\n      content: 'Loading...'\n    }]);\n    setMessageHistory([initialMessage]);\n    const response = await InitialMessageToChatGPT(initialPrompt);\n    setMessages([{\n      role: 'assistant',\n      content: response\n    }]);\n    setMessageHistory(prevHistory => [...prevHistory, {\n      role: 'assistant',\n      content: response\n    }]);\n  };\n  // setMessageHistory([{ role: 'assistant', content: response }]);\n\n  const sendMessageToChatGPT = async promptMessages => {\n    console.log(\"after updating\", promptMessages);\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer sk-proj-Ujro97vuIFi0BvhkpHnET3BlbkFJ2eiNRzcGGHMHfman9iiE'\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: promptMessages\n      })\n    });\n    const data = await response.json();\n    if (data.choices && data.choices.length > 0) {\n      const replyText = data.choices[0].message.content;\n      return replyText;\n    } else {\n      return \"Failed to get a response\";\n    }\n  };\n  const InitialMessageToChatGPT = async quest => {\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer sk-proj-ClyheMv50nSvIf1Q3g84T3BlbkFJoZ6isdGyOQEQcCm8GlzN'\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: [{\n          role: \"system\",\n          content: quest\n        }]\n      })\n    });\n    const data = await response.json();\n    if (data.choices && data.choices.length > 0) {\n      const replyText = data.choices[0].message.content;\n      return replyText;\n    } else {\n      return \"Failed to get a response\";\n    }\n  };\n  const chatbotMapping = {\n    'Social': 'socialLife',\n    'Academia': 'academia',\n    'Wellness': 'wellness',\n    'tutor': 'tutor'\n  };\n  const getChatbotFromPrompt = urlPrompt => {\n    for (const key in chatbotMapping) {\n      if (urlPrompt.includes(key)) {\n        return chatbotMapping[key];\n      }\n    }\n    return null;\n  };\n  const generateUniqueId = () => {\n    const timestamp = Date.now();\n    const randomNumber = Math.random();\n    const hexadecimalString = randomNumber.toString(16);\n    return `id-${timestamp}-${hexadecimalString}`;\n  };\n  const chatStripe = (ai_bool, value, uniqueId) => {\n    return `\n      <div class=\"wrapper ${ai_bool ? styles.ai : ''}\">\n        <div class=\"chat\">\n          <div class=\"profile\">\n            <img\n              src=\"${ai_bool ? dalleBot : user}\"\n              alt=\"${ai_bool ? \"bot\" : \"user\"}\"\n            />\n          </div>\n          <div class=\"message\" id=${uniqueId}>${value}</div>\n        </div>\n      </div>\n    `;\n  };\n  const loader = element => {\n    element.textContent = \"\";\n    let loadInterval = setInterval(() => {\n      element.textContent += \".\";\n      if (element.textContent === \"....\") {\n        element.textContent = \"\";\n      }\n    }, 300);\n  };\n  const typeText = (element, text, callback) => {\n    let index = 0;\n    let interval = setInterval(() => {\n      if (index < text.length) {\n        element.innerHTML += text.charAt(index);\n        document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n        ++index;\n      } else {\n        clearInterval(interval);\n        if (callback) callback();\n      }\n    }, 20);\n  };\n  const generateEmailPrompt = conversationHistory => {\n    return `\n      You are a helpful assistant. Based on the following conversation history, generate a detailed and polite email for a Virginia Tech advisor. The email should be written from the perspective of a Virginia Tech student asking for more information or assistance based on their enquiry.\n\n      Conversation History: ${conversationHistory.map(message => {\n      return `\\n${message.role === 'user' ? 'User' : 'Assistant'}: ${message.content}`;\n    }).join('')}\n\n      The name of the student is ${apiData === null || apiData === void 0 ? void 0 : apiData.firstName}\n\n      Please ensure the email includes:\n      - A formal greeting.\n      - A clear and detailed description of the student's enquiry.\n      - Relevant details or context that the student has provided.\n      - A polite closing statement thanking the advisor for their time and asking for more detailed information or assistance.\n      - Keep it short and professional\n\n      The email should be structured formally and professionally, appropriate for a university setting.\n    `;\n  };\n  const handleYesNoButtons = (replyText, uniqueId) => {\n    if (replyText.toLowerCase().includes(\"help\")) {\n      const yesButton = document.createElement(\"button\");\n      yesButton.className = styles.yesButton; // Correct class name\n      yesButton.textContent = \"Yes\";\n      const noButton = document.createElement(\"button\");\n      noButton.className = styles.noButton; // Correct class name\n      noButton.textContent = \"No\";\n      const buttonContainer = document.createElement(\"div\");\n      buttonContainer.id = styles.buttonContainer; // Correct class name\n      buttonContainer.appendChild(yesButton);\n      buttonContainer.appendChild(noButton);\n      document.querySelector(`.${styles.chatContainer}`).appendChild(buttonContainer);\n      document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n      noButton.addEventListener(\"click\", () => {\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'user',\n          content: \"No\"\n        }, {\n          role: 'assistant',\n          content: \"Thank you! Please let me know if you have more questions.\"\n        }]);\n        setMessageHistory(prevHistory => [...prevHistory, {\n          role: 'user',\n          content: \"No\"\n        }, {\n          role: 'assistant',\n          content: \"Thank you! Please let me know if you have more questions.\"\n        }]);\n        document.getElementById(styles.buttonContainer).remove();\n        scrollToBottom();\n      });\n      yesButton.addEventListener(\"click\", () => {\n        setMessages(prevMessages => [...prevMessages, {\n          role: 'user',\n          content: \"Yes\"\n        }, {\n          role: 'assistant',\n          content: \"Would you like to email the advisor or continue the conversation?\",\n          id: uniqueId\n        }]);\n        setMessageHistory(prevHistory => [...prevHistory, {\n          role: 'user',\n          content: \"Yes\"\n        }]);\n        const responseDiv = document.createElement(\"div\");\n        responseDiv.id = styles.botMessage; // Correct class name\n\n        const emailButton = document.createElement(\"button\");\n        emailButton.className = styles.responseButton; // Correct class name\n        emailButton.textContent = \"Email Advisor\";\n        const askMindcraftButton = document.createElement(\"button\");\n        askMindcraftButton.className = styles.responseButton; // Correct class name\n        askMindcraftButton.textContent = \"Continue Chat\";\n        responseDiv.appendChild(document.createElement(\"br\"));\n        responseDiv.appendChild(emailButton);\n        responseDiv.appendChild(askMindcraftButton);\n\n        // Append buttons directly after the last message\n        scrollToBottom();\n        setTimeout(() => {\n          scrollToBottom();\n          document.querySelector(`.${styles.chatContainer}`).appendChild(responseDiv);\n          // const lastMessageElement = document.querySelector(`.${styles.chatContainer} .${styles.wrapper}:last-child`);\n          // if (lastMessageElement) {\n          //   lastMessageElement.appendChild(responseDiv);\n          // }\n\n          document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n        }, 100);\n        document.getElementById(styles.buttonContainer).remove();\n\n        //   yesButton.addEventListener(\"click\", () => {\n        //     setMessages((prevMessages) => [\n        //       ...prevMessages,\n        //       { role: 'user', content: \"Yes\" },\n        //       { role: 'assistant', content: \"Would you like to email the advisor or continue the conversation?\", id: uniqueId }\n        //     ]);\n        //     setMessageHistory((prevHistory) => [\n        //       ...prevHistory,\n        //       { role: 'user', content: \"Yes\" }\n        //     ]);\n        //     const responseDiv = document.createElement(\"div\");\n        //     responseDiv.id = styles.botMessage; // Correct class name\n\n        //     const emailButton = document.createElement(\"button\");\n        //     emailButton.className = styles.responseButton; // Correct class name\n        //     emailButton.textContent = \"Email Advisor\";\n        //     const askMindcraftButton = document.createElement(\"button\");\n        //     askMindcraftButton.className = styles.responseButton; // Correct class name\n        //     askMindcraftButton.textContent = \"Continue Chat\";\n        //     document.getElementById(styles.buttonContainer).remove();\n\n        //     responseDiv.appendChild(document.createElement(\"br\"));\n        //     responseDiv.appendChild(emailButton);\n        //     responseDiv.appendChild(askMindcraftButton);\n\n        //     document.querySelector(`.${styles.chatContainer}`).appendChild(responseDiv);\n        //     // const lastMessageElement = document.querySelector(`.${styles.chatContainer} .${styles.message}[id='${uniqueId}']`);\n        //     // if (lastMessageElement) {\n        //     //   lastMessageElement.parentNode.appendChild(responseDiv);\n        //     // }\n        //     document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n        //     document.getElementById(styles.buttonContainer).remove();\n\n        emailButton.addEventListener(\"click\", async () => {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'user',\n            content: \"Yes, Please help me email my advisor\"\n          }]);\n          setMessageHistory(prevHistory => [...prevHistory, {\n            role: 'user',\n            content: \"Yes, Please help me email my advisor\"\n          }]);\n          const emailPrompt = generateEmailPrompt(messageHistory);\n          const emailResponse = await sendMessageToChatGPT([{\n            role: \"user\",\n            content: emailPrompt\n          }]);\n          const subjectMatch = emailResponse.match(/Subject: (.*)\\n/);\n          const subject = subjectMatch ? subjectMatch[1] : \"Inquiry\";\n          const body = emailResponse.replace(/Subject: .*?\\n/, \"\");\n          const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n          window.location.href = mailtoLink;\n          document.getElementById(styles.botMessage).remove();\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'assistant',\n            content: \"Hope I answered your question. Please let me know if you have more questions\"\n          }]);\n          setMessageHistory(prevHistory => [...prevHistory, {\n            role: 'assistant',\n            content: \"Hope I answered your question. Please let me know if you have more questions\"\n          }]);\n        });\n        scrollToBottom();\n        askMindcraftButton.addEventListener(\"click\", () => {\n          setMessages(prevMessages => [...prevMessages, {\n            role: 'user',\n            content: \"Continue chat\"\n          }, {\n            role: 'assistant',\n            content: \"Please provide more details or ask another question.\"\n          }]);\n          setMessageHistory(prevHistory => [...prevHistory, {\n            role: 'user',\n            content: \"Continue chat\"\n          }, {\n            role: 'assistant',\n            content: \"Please provide more details or ask another question.\"\n          }]);\n          document.getElementById(styles.botMessage).remove();\n        });\n      });\n      scrollToBottom();\n    }\n  };\n  const setPromptForCategory = category => {\n    const buttonContainer = document.getElementById(styles.buttonContainer);\n    if (buttonContainer) {\n      buttonContainer.remove();\n    }\n    const botMessage = document.getElementById(styles.botMessage);\n    if (botMessage) {\n      botMessage.remove();\n    }\n    let prompt;\n    console.log(\"AFTER \" + username + \"username\");\n    console.log(\"AFTER \" + (apiData === null || apiData === void 0 ? void 0 : apiData.firstName));\n    console.log(\" AFTER \" + (apiData === null || apiData === void 0 ? void 0 : apiData.profile));\n    switch (category) {\n      case 'socialLife':\n        prompt = `You are a college life coordinator for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your job is to link resources and/or talk about activities you can do on campus in regards to social life.\n              Your are essentially pulling information about ongoing campus events at Virginia Tech, what you can do as a college student on campus in and out of\n              campus and outside in Blacksburg and nearby Christiansburg and Roanoke in Virginia. This also includes how to have fun with friends, groups, joining organizations\n              and clubs, and doing all sorts of events and getting involved with extracurriculars. This includes stuff from \n              Gobblerconnect, a website that hosts event listinngs and club/organization listings\n              you can join and in general calendars you can find by email like listserv notifications from organizations, and calendars embedded into the Virginia Tech college website\n              and the calendar found on google or others found from related websites\n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a college life coordinator by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData === null || apiData === void 0 ? void 0 : apiData.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Social Life Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D`;\n        break;\n      case 'academia':\n        prompt = `You are a academic advisor for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about courses, information on courses such as knowing what teacher is teaching or general heuristic knowledge about the class like \n              what they teach and how long each class is. This also can be about how to sign up for such a class, the steps to sign up, prerequisites, among ther logistical knowledge\n              that is involved with courses. This can be about majors, pricing for credits, and anything related to classes, graduation, or a student's learning. This topic can also be\n              a way to guide students on how to survive classes in general and strategies to survive and thrive in classes. Important deadlines and there important heuristics that \n              are constantly updates are listed here.\n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a academic advisor by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData === null || apiData === void 0 ? void 0 : apiData.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Academia Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D`;\n        break;\n      case 'wellness':\n        prompt = `You are a embedded college counselor for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about resources for students. They can be exisiting outside resources around Blacksburg, Christiansburg, and Roanoke and inside campus resources. These resources include anything regarding \n              mental health, physical health, disability services, food and dietary support, financial aid and support, housing information and costs of living, and anything in general\n              that regards useful everyday resources to help with the students needs that are listed currently on Virginia Tech on the websites and other affiliated resources. \n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a embedded college counselor by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData === null || apiData === void 0 ? void 0 : apiData.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Wellness Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\n              `;\n        break;\n      case 'tutor':\n        prompt = `You lead and have a list of tutors for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about giving information for students regarding listed tutors found. \n    \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n    \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n    \n              Your task is to provide answers to student's question in the text given as an assitant that holds information regarding college tutorinng by:\n    \n              1. Starting with a greeting to the user by saying:\"Hi ${apiData === null || apiData === void 0 ? void 0 : apiData.firstName}}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Tutor Assistant! What is/are your question(s) for today?\n    \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n    \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n    \n              4.  The output of your response should be first with a introductory paragraph of what you found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer. You should list in detail their name, introduction, rating, qualifications\n              specialization with skills and subjects the tutor is good at, teaching approach, year if they are a current student or employee, reasonable pricing for a tutor, availability, contact phone number, \n              and social media. Then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n    \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\"\n    \n              6. For the first prompt, Please dont include any tutor's name or details. Just greet the user as mentioned above. \n    \n              NOTE: if you can't find a given tutor name or certain info:\n    \n              1. For no info at all make up a fake tutor with the guven info and make it similar to actual tutors you find.\n    \n              2. If you do find real tutors but not find all pieces of information you can try your best to find it but else say:\n                  - \"This is all the information I can find.\" This should be right before step 5 above.\n                  - Also list the information as you do normally.\n                  \n              Please make sure to format this response logically as how actual tutor websites online do it (may use internet to find how)\n              and list things in an order that is logical.\n    \n              `;\n        break;\n      default:\n        prompt = \"I'm not sure what you're asking. Can you specify a bit more?\";\n        break;\n    }\n    navigate(`/chatbot/${category}`, {\n      state: {\n        prompt\n      }\n    });\n  };\n  const showLoading = () => {\n    document.getElementById('loading').style.display = 'flex';\n  };\n  const scrollToBottom = () => {\n    const chatContainer = document.querySelector(`.${styles.chatContainer}`);\n    chatContainer.scrollTop = chatContainer.scrollHeight;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.chatPage,\n    children: [\" \", /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"loading\",\n        style: {\n          position: 'fixed',\n          width: '100%',\n          height: '100%',\n          top: 0,\n          left: 0,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          background: '#861F41',\n          zIndex: 1000\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: dalleBot,\n          id: styles.loadingImage,\n          alt: \"loading\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 621,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: styles.app,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: styles.header,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            id: styles.homeButton,\n            onClick: handleHomeClick,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: homeIcon,\n              alt: \"Home\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            id: styles.chatHeader,\n            children: \"MindCraft VT Chatbot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 643,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            id: styles.categorySelector,\n            defaultValue: category,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"socialLife\",\n              children: \"Social Life\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"academia\",\n              children: \"Academia\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 646,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"wellness\",\n              children: \"Wellness\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 647,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"tutor\",\n              children: \"Tutor\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: styles.chatContainer,\n          className: styles.chatContainer,\n          children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `${styles.wrapper} ${msg.role === 'assistant' ? styles.ai : ''}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.chat,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.profile,\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: msg.role === 'assistant' ? dalleBot : (apiData === null || apiData === void 0 ? void 0 : apiData.profile) || user,\n                  alt: msg.role\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 656,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 655,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.message,\n                id: msg.id,\n                children: msg.content\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 658,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 654,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 653,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 651,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            name: \"prompt\",\n            required: true,\n            rows: \"1\",\n            cols: \"1\",\n            placeholder: \"Ask MindCraft VT...\",\n            value: input,\n            onChange: e => setInput(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 664,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            id: styles.submitButton,\n            className: styles.submitButton,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: sendButton,\n              alt: \"Send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 674,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 673,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 663,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 638,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 619,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatPage, \"VBS3WSuRmcDGGFJ7UgPqAbyXHn0=\", false, function () {\n  return [useParams, useLocation, useNavigate, useAuthStore, useFetch];\n});\n_c = ChatPage;\nexport default ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","useParams","homeIcon","dalleBot","sendButton","styles","user","useAuthStore","useFetch","ChatPage","category","location","navigate","prompt","state","input","setInput","messages","setMessages","messageHistory","setMessageHistory","quest","setQuest","studentName","userName","setUserName","userImage","setUserImage","username","auth","isLoading","apiData","serverError","loadingElement","document","getElementById","setTimeout","style","display","initialChatGPT","console","log","urlParams","URLSearchParams","window","search","currentChatbot","getChatbotFromPrompt","String","selector","value","selectedIndex","prompt_url","get","categorySelector","handleCategoryChange","firstName","profile","setPromptForCategory","addEventListener","removeEventListener","handleHomeClick","showLoading","handleSubmit","e","preventDefault","trim","newMessage","role","content","handleChatGPT","message","uniqueId","generateUniqueId","id","prevMessages","concat","response","sendMessageToChatGPT","updatedMessages","index","findIndex","msg","typeText","handleYesNoButtons","prevHistory","initialPrompt","initialMessage","InitialMessageToChatGPT","promptMessages","fetch","method","headers","body","JSON","stringify","model","data","json","choices","length","replyText","chatbotMapping","urlPrompt","key","includes","timestamp","Date","now","randomNumber","Math","random","hexadecimalString","toString","chatStripe","ai_bool","ai","loader","element","textContent","loadInterval","setInterval","text","callback","interval","innerHTML","charAt","querySelector","chatContainer","scrollTop","scrollHeight","clearInterval","generateEmailPrompt","conversationHistory","map","join","toLowerCase","yesButton","createElement","className","noButton","buttonContainer","appendChild","remove","scrollToBottom","responseDiv","botMessage","emailButton","responseButton","askMindcraftButton","emailPrompt","emailResponse","subjectMatch","match","subject","replace","mailtoLink","encodeURIComponent","href","chatPage","position","width","height","top","left","justifyContent","alignItems","background","zIndex","loadingImage","app","header","homeButton","chatHeader","wrapper","chat","target","submitButton"],"sources":["/Users/roshanravindran/Downloads/MERN_Login_App_with_ResetEmail-Main/client/src/components/ChatPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport homeIcon from '../assets/home.png';\nimport dalleBot from '../assets/dalle_bot.jpg';\nimport sendButton from '../assets/send_button.png';\nimport styles from '../styles/ChatPage.module.css';\nimport user from '../assets/vt_student.jpg';\nimport { useAuthStore } from '../store/store'\nimport useFetch from '../hooks/fetch.hook';\n\n\n\n\nconst ChatPage = () => {\n  const { category } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { prompt } = location.state || {};\n  const [input, setInput] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [messageHistory, setMessageHistory] = useState([]);\n  const [quest, setQuest] = useState('');\n  const studentName = \"Roshan Ravindran\";\n  const [userName, setUserName] = useState('');\n  const [userImage, setUserImage] = useState(user);\n  const { username } = useAuthStore(state => state.auth)\n\n  const [{ isLoading, apiData, serverError }] = useFetch(`/user/${username}`)\n\n\n  useEffect(() => {\n    const loadingElement = document.getElementById('loading');\n    setTimeout(() => {\n      if (loadingElement) loadingElement.style.display = 'none';\n    }, 1500);\n    // fetchUserData();\n    // console.log(\"username\" + username)\n    // console.log(apiData?.firstName)\n    // console.log(apiData?.profile)\n\n    if (prompt) {\n      initialChatGPT(prompt);\n      console.log(\"the prompt is\" + prompt)\n    }\n  }, [prompt]);\n  useEffect(() => {\n    console.log(\"Message History Updated:\", messageHistory);\n  }, [messageHistory]);\n\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const currentChatbot = getChatbotFromPrompt(String(urlParams));\n    const selector = document.getElementById('category-selector');\n\n    if (selector) {\n      if (currentChatbot) {\n        selector.value = currentChatbot;\n      } else {\n        selector.selectedIndex = 0;\n      }\n    }\n\n    const prompt_url = urlParams.get('prompt');\n    if (prompt_url) {\n      setQuest(prompt_url);\n    }\n  }, []);\n  useEffect(() => {\n    const categorySelector = document.getElementById(styles.categorySelector);\n    if (categorySelector) {\n      const handleCategoryChange = function () {\n        console.log(\"AFTER \" + this.value);\n        if (this.value) {\n          console.log(\"username\" + username)\n          console.log(apiData?.firstName)\n          console.log(apiData?.profile)\n          setPromptForCategory(this.value);\n      \n        }\n      };\n\n      categorySelector.addEventListener('change', handleCategoryChange);\n\n      // Cleanup event listener\n      return () => {\n        categorySelector.removeEventListener('change', handleCategoryChange);\n      };\n    }\n  }, []);\n  // const fetchUserData = async () => {\n  //   try {\n  //     const response = await fetch('http://localhost:8080/api/user'); // Adjust the API endpoint as needed\n  //     const data = await response.json();\n  //     setUserName(data.username);\n  //     setUserImage(data.profilePicture || user);\n  //   } catch (error) {\n  //     console.error('Failed to fetch user data:', error);\n  //   }\n  // };\n\n  const handleHomeClick = () => {\n    showLoading();\n    setTimeout(() => {\n      navigate('/chatbot');\n    }, 1500);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    console.log(\"clicked on the submit button\")\n    if (input.trim() === \"\") {\n      return;\n    }\n\n    const newMessage = { role: 'user', content: input };\n    console.log(\"input\" + newMessage.role + newMessage.content)\n    setMessages([...messages, newMessage]);\n    setMessageHistory([...messageHistory, newMessage]);\n    setInput('');\n\n    await handleChatGPT(input);\n  };\n\n  const handleChatGPT = async (message) => {\n    const uniqueId = generateUniqueId();\n    const newMessage = { role: 'assistant', content: 'Loading...', id: uniqueId };\n    setMessages((prevMessages) => [...prevMessages, newMessage]);\n    messageHistory.concat([{ role: 'user', content: message }])\n\n    const response = await sendMessageToChatGPT(messageHistory.concat([{ role: 'user', content: message }]));\n\n    setMessages((prevMessages) => {\n      const updatedMessages = [...prevMessages];\n      const index = updatedMessages.findIndex(msg => msg.id === uniqueId);\n      if (index !== -1) {\n        updatedMessages[index].content = '';\n        typeText(document.getElementById(uniqueId), response, () => handleYesNoButtons(response, uniqueId));\n      }\n      return updatedMessages;\n    });\n\n    setMessageHistory((prevHistory) => [...prevHistory, { role: 'assistant', content: response }]);\n  };\n\n  const initialChatGPT = async (initialPrompt) => {\n    setQuest(initialPrompt);\n    const initialMessage = { role: 'system', content: initialPrompt };\n\n    setMessages([{ role: 'assistant', content: 'Loading...' }]);\n    setMessageHistory([initialMessage]);\n    const response = await InitialMessageToChatGPT(initialPrompt);\n    setMessages([{ role: 'assistant', content: response }]);\n        setMessageHistory((prevHistory) => [...prevHistory, { role: 'assistant', content: response }]);\n    };\n    // setMessageHistory([{ role: 'assistant', content: response }]);\n\n  const sendMessageToChatGPT = async (promptMessages) => {\n    console.log(\"after updating\" , promptMessages);\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer sk-proj-Ujro97vuIFi0BvhkpHnET3BlbkFJ2eiNRzcGGHMHfman9iiE'\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: promptMessages\n      })\n    });\n    const data = await response.json();\n    if (data.choices && data.choices.length > 0) {\n      const replyText = data.choices[0].message.content;\n      return replyText;\n    } else {\n      return \"Failed to get a response\";\n    }\n  };\n\n  const InitialMessageToChatGPT = async (quest) => {\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer sk-proj-ClyheMv50nSvIf1Q3g84T3BlbkFJoZ6isdGyOQEQcCm8GlzN'\n      },\n      body: JSON.stringify({\n        model: \"gpt-3.5-turbo\",\n        messages: [{ role: \"system\", content: quest }]\n      })\n    });\n    const data = await response.json();\n    if (data.choices && data.choices.length > 0) {\n      const replyText = data.choices[0].message.content;\n      return replyText;\n    } else {\n      return \"Failed to get a response\";\n    }\n  };\n\n  const chatbotMapping = {\n    'Social': 'socialLife',\n    'Academia': 'academia',\n    'Wellness': 'wellness',\n    'tutor': 'tutor'\n  };\n\n  const getChatbotFromPrompt = (urlPrompt) => {\n    for (const key in chatbotMapping) {\n      if (urlPrompt.includes(key)) {\n        return chatbotMapping[key];\n      }\n    }\n    return null;\n  };\n\n  const generateUniqueId = () => {\n    const timestamp = Date.now();\n    const randomNumber = Math.random();\n    const hexadecimalString = randomNumber.toString(16);\n\n    return `id-${timestamp}-${hexadecimalString}`;\n  };\n\n  const chatStripe = (ai_bool, value, uniqueId) => {\n    return `\n      <div class=\"wrapper ${ai_bool ? styles.ai : ''}\">\n        <div class=\"chat\">\n          <div class=\"profile\">\n            <img\n              src=\"${ai_bool ? dalleBot : user}\"\n              alt=\"${ai_bool ? \"bot\" : \"user\"}\"\n            />\n          </div>\n          <div class=\"message\" id=${uniqueId}>${value}</div>\n        </div>\n      </div>\n    `;\n  };\n\n  const loader = (element) => {\n    element.textContent = \"\";\n    let loadInterval = setInterval(() => {\n      element.textContent += \".\";\n      if (element.textContent === \"....\") {\n        element.textContent = \"\";\n      }\n    }, 300);\n  };\n\n  const typeText = (element, text, callback) => {\n    let index = 0;\n    let interval = setInterval(() => {\n      if (index < text.length) {\n        element.innerHTML += text.charAt(index);\n        document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n        ++index;\n      } else {\n        clearInterval(interval);\n        if (callback) callback();\n      }\n    }, 20);\n  };\n\n  const generateEmailPrompt = (conversationHistory) => {\n    return `\n      You are a helpful assistant. Based on the following conversation history, generate a detailed and polite email for a Virginia Tech advisor. The email should be written from the perspective of a Virginia Tech student asking for more information or assistance based on their enquiry.\n\n      Conversation History: ${conversationHistory.map(message => {\n        return `\\n${message.role === 'user' ? 'User' : 'Assistant'}: ${message.content}`;\n      }).join('')}\n\n      The name of the student is ${apiData?.firstName}\n\n      Please ensure the email includes:\n      - A formal greeting.\n      - A clear and detailed description of the student's enquiry.\n      - Relevant details or context that the student has provided.\n      - A polite closing statement thanking the advisor for their time and asking for more detailed information or assistance.\n      - Keep it short and professional\n\n      The email should be structured formally and professionally, appropriate for a university setting.\n    `;\n  };\n\n  const handleYesNoButtons = (replyText, uniqueId) => {\n    if (replyText.toLowerCase().includes(\"help\")) {\n      const yesButton = document.createElement(\"button\");\n      yesButton.className = styles.yesButton; // Correct class name\n      yesButton.textContent = \"Yes\";\n      const noButton = document.createElement(\"button\");\n      noButton.className = styles.noButton; // Correct class name\n      noButton.textContent = \"No\";\n\n      const buttonContainer = document.createElement(\"div\");\n      buttonContainer.id = styles.buttonContainer; // Correct class name\n      buttonContainer.appendChild(yesButton);\n      buttonContainer.appendChild(noButton);\n      document.querySelector(`.${styles.chatContainer}`).appendChild(buttonContainer);\n\n      document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n\n      noButton.addEventListener(\"click\", () => {\n        setMessages((prevMessages) => [\n          ...prevMessages,\n          { role: 'user', content: \"No\" },\n          { role: 'assistant', content: \"Thank you! Please let me know if you have more questions.\" }\n        ]);\n        setMessageHistory((prevHistory) => [\n          ...prevHistory,\n          { role: 'user', content: \"No\" },\n          { role: 'assistant', content: \"Thank you! Please let me know if you have more questions.\" }\n        ]);\n        document.getElementById(styles.buttonContainer).remove();\n        scrollToBottom();\n      });\n      yesButton.addEventListener(\"click\", () => {\n        setMessages((prevMessages) => [\n            ...prevMessages,\n            { role: 'user', content: \"Yes\" },\n            { role: 'assistant', content: \"Would you like to email the advisor or continue the conversation?\", id: uniqueId }\n          ]);\n          setMessageHistory((prevHistory) => [\n            ...prevHistory,\n            { role: 'user', content: \"Yes\" }\n          ]);\n          \n          const responseDiv = document.createElement(\"div\");\n          responseDiv.id = styles.botMessage; // Correct class name\n  \n          const emailButton = document.createElement(\"button\");\n          emailButton.className = styles.responseButton; // Correct class name\n          emailButton.textContent = \"Email Advisor\";\n          const askMindcraftButton = document.createElement(\"button\");\n          askMindcraftButton.className = styles.responseButton; // Correct class name\n          askMindcraftButton.textContent = \"Continue Chat\";\n  \n          responseDiv.appendChild(document.createElement(\"br\"));\n          responseDiv.appendChild(emailButton);\n          responseDiv.appendChild(askMindcraftButton);\n  \n          // Append buttons directly after the last message\n          scrollToBottom();\n  \n          setTimeout(() => {\n            scrollToBottom();\n            document.querySelector(`.${styles.chatContainer}`).appendChild(responseDiv);\n            // const lastMessageElement = document.querySelector(`.${styles.chatContainer} .${styles.wrapper}:last-child`);\n            // if (lastMessageElement) {\n            //   lastMessageElement.appendChild(responseDiv);\n            // }\n  \n            document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n          }, 100);\n          document.getElementById(styles.buttonContainer).remove();\n      \n\n    //   yesButton.addEventListener(\"click\", () => {\n    //     setMessages((prevMessages) => [\n    //       ...prevMessages,\n    //       { role: 'user', content: \"Yes\" },\n    //       { role: 'assistant', content: \"Would you like to email the advisor or continue the conversation?\", id: uniqueId }\n    //     ]);\n    //     setMessageHistory((prevHistory) => [\n    //       ...prevHistory,\n    //       { role: 'user', content: \"Yes\" }\n    //     ]);\n    //     const responseDiv = document.createElement(\"div\");\n    //     responseDiv.id = styles.botMessage; // Correct class name\n\n    //     const emailButton = document.createElement(\"button\");\n    //     emailButton.className = styles.responseButton; // Correct class name\n    //     emailButton.textContent = \"Email Advisor\";\n    //     const askMindcraftButton = document.createElement(\"button\");\n    //     askMindcraftButton.className = styles.responseButton; // Correct class name\n    //     askMindcraftButton.textContent = \"Continue Chat\";\n    //     document.getElementById(styles.buttonContainer).remove();\n\n\n    //     responseDiv.appendChild(document.createElement(\"br\"));\n    //     responseDiv.appendChild(emailButton);\n    //     responseDiv.appendChild(askMindcraftButton);\n\n    //     document.querySelector(`.${styles.chatContainer}`).appendChild(responseDiv);\n    //     // const lastMessageElement = document.querySelector(`.${styles.chatContainer} .${styles.message}[id='${uniqueId}']`);\n    //     // if (lastMessageElement) {\n    //     //   lastMessageElement.parentNode.appendChild(responseDiv);\n    //     // }\n    //     document.querySelector(`.${styles.chatContainer}`).scrollTop = document.querySelector(`.${styles.chatContainer}`).scrollHeight;\n    //     document.getElementById(styles.buttonContainer).remove();\n\n\n        emailButton.addEventListener(\"click\", async () => {\n          setMessages((prevMessages) => [\n            ...prevMessages,\n            { role: 'user', content: \"Yes, Please help me email my advisor\" }\n          ]);\n          setMessageHistory((prevHistory) => [\n            ...prevHistory,\n            { role: 'user', content: \"Yes, Please help me email my advisor\" }\n          ]);\n\n          const emailPrompt = generateEmailPrompt(messageHistory);\n          const emailResponse = await sendMessageToChatGPT([{ role: \"user\", content: emailPrompt }]);\n          const subjectMatch = emailResponse.match(/Subject: (.*)\\n/);\n          const subject = subjectMatch ? subjectMatch[1] : \"Inquiry\";\n          const body = emailResponse.replace(/Subject: .*?\\n/, \"\");\n\n          const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n          window.location.href = mailtoLink;\n\n          document.getElementById(styles.botMessage).remove();\n          setMessages((prevMessages) => [\n            ...prevMessages,\n            { role: 'assistant', content: \"Hope I answered your question. Please let me know if you have more questions\" }\n          ]);\n          setMessageHistory((prevHistory) => [\n            ...prevHistory,\n            { role: 'assistant', content: \"Hope I answered your question. Please let me know if you have more questions\" }\n          ]);\n        });\n        scrollToBottom();\n\n        askMindcraftButton.addEventListener(\"click\", () => {\n          setMessages((prevMessages) => [\n            ...prevMessages,\n            { role: 'user', content: \"Continue chat\" },\n            { role: 'assistant', content: \"Please provide more details or ask another question.\" }\n          ]);\n          setMessageHistory((prevHistory) => [\n            ...prevHistory,\n            { role: 'user', content: \"Continue chat\" },\n            { role: 'assistant', content: \"Please provide more details or ask another question.\" }\n          ]);\n          document.getElementById(styles.botMessage).remove();\n        });\n      });\n      scrollToBottom();\n    }\n  };\n  const setPromptForCategory = (category) => {\n    const buttonContainer = document.getElementById(styles.buttonContainer);\n    if (buttonContainer) {\n      buttonContainer.remove();\n    }\n    const botMessage = document.getElementById(styles.botMessage);\n    if (botMessage) {\n      botMessage.remove();\n    }\n    let prompt;\n    console.log(\"AFTER \" + username + \"username\")\n    console.log(\"AFTER \" + apiData?.firstName)\n    console.log(\" AFTER \" + apiData?.profile)\n    switch (category) {\n        case 'socialLife':\n          prompt = `You are a college life coordinator for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your job is to link resources and/or talk about activities you can do on campus in regards to social life.\n              Your are essentially pulling information about ongoing campus events at Virginia Tech, what you can do as a college student on campus in and out of\n              campus and outside in Blacksburg and nearby Christiansburg and Roanoke in Virginia. This also includes how to have fun with friends, groups, joining organizations\n              and clubs, and doing all sorts of events and getting involved with extracurriculars. This includes stuff from \n              Gobblerconnect, a website that hosts event listinngs and club/organization listings\n              you can join and in general calendars you can find by email like listserv notifications from organizations, and calendars embedded into the Virginia Tech college website\n              and the calendar found on google or others found from related websites\n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a college life coordinator by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData?.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Social Life Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D`;\n          break;\n        case 'academia':\n          prompt = `You are a academic advisor for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about courses, information on courses such as knowing what teacher is teaching or general heuristic knowledge about the class like \n              what they teach and how long each class is. This also can be about how to sign up for such a class, the steps to sign up, prerequisites, among ther logistical knowledge\n              that is involved with courses. This can be about majors, pricing for credits, and anything related to classes, graduation, or a student's learning. This topic can also be\n              a way to guide students on how to survive classes in general and strategies to survive and thrive in classes. Important deadlines and there important heuristics that \n              are constantly updates are listed here.\n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a academic advisor by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData?.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Academia Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D`;\n          break;\n        case 'wellness':\n          prompt = `You are a embedded college counselor for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about resources for students. They can be exisiting outside resources around Blacksburg, Christiansburg, and Roanoke and inside campus resources. These resources include anything regarding \n              mental health, physical health, disability services, food and dietary support, financial aid and support, housing information and costs of living, and anything in general\n              that regards useful everyday resources to help with the students needs that are listed currently on Virginia Tech on the websites and other affiliated resources. \n              \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n              \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n              \n              Your task is to provide answers to student's question in the text given as a embedded college counselor by:\n              \n              1. Start with a greeting to the user by saying:\"Hi ${apiData?.firstName}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Wellness Assistant! What is/are your question(s) for today?\n              \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n              \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n              \n              4.  The output of your response should be first with a introductory paragraph of what your found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer, BUT do not do this for most prompts if \n              it seems explicitly not needed. Instead if not needed, write in about 4-5 paragraphs explaining what you found. Finally have one final paragraph summarizing \n              the answer you found and then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n              \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\n              `;\n          break;\n        case 'tutor':\n          prompt = `You lead and have a list of tutors for the real college called Virginia Polytechnic Institute and State University\n              or Virginia Tech for short. Your information is all essentially about giving information for students regarding listed tutors found. \n    \n              You will adhere to a consistent style of talking that is appropriate of a professional adult working a college job.\n    \n              You also are able to access the Internet to get links. Make sure they are working links and will not result in a 404 error.\n    \n              Your task is to provide answers to student's question in the text given as an assitant that holds information regarding college tutorinng by:\n    \n              1. Starting with a greeting to the user by saying:\"Hi ${apiData?.firstName}}! Welcome to Mindcraft VT Assistant! My name is Mindcraft VT Tutor Assistant! What is/are your question(s) for today?\n    \n              2. Take the user input of the question and answer to the best of your abilities including adding links that users can click \n    \n              3. If they are not in these categories OR they are out of the scope of what you can give users then say:\n              \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\" \n    \n              4.  The output of your response should be first with a introductory paragraph of what you found. Then in a list format of \n              bullet points show all of the options, details, etc in terms of what you were trying to answer. You should list in detail their name, introduction, rating, qualifications\n              specialization with skills and subjects the tutor is good at, teaching approach, year if they are a current student or employee, reasonable pricing for a tutor, availability, contact phone number, \n              and social media. Then the final question where you ask the user specifically:\n              \"Do you need more help?\"\n    \n              5. Following step 4 for the text \"Does this answer your question?\" If they say anything similar to the word \"Yes\" within context then say:\n              \"Hope this was helpful!\" If the user says \"No\", prompt the user by saying: \"Sure! What else do you want to know or need clarification about?\" Proceed\n              to then follow the previous steps starting from step 2. Use the question before as guidance and keep on topic. If they give an answer not on or similar to\n              said topic or within the category then say \"Sorry I don't believe I am able to answer your question in regards. Would you mind rewording your question or \n              answering a different one? If not thank you for using our service!:D\"\n    \n              6. For the first prompt, Please dont include any tutor's name or details. Just greet the user as mentioned above. \n    \n              NOTE: if you can't find a given tutor name or certain info:\n    \n              1. For no info at all make up a fake tutor with the guven info and make it similar to actual tutors you find.\n    \n              2. If you do find real tutors but not find all pieces of information you can try your best to find it but else say:\n                  - \"This is all the information I can find.\" This should be right before step 5 above.\n                  - Also list the information as you do normally.\n                  \n              Please make sure to format this response logically as how actual tutor websites online do it (may use internet to find how)\n              and list things in an order that is logical.\n    \n              `;\n          break;\n    \n        default:\n          prompt = \"I'm not sure what you're asking. Can you specify a bit more?\";\n          break;\n      }\n    navigate(`/chatbot/${category}`, { state: { prompt } });\n  };\n  const showLoading = () => {\n    document.getElementById('loading').style.display = 'flex';\n  };\n  const scrollToBottom = () => {\n    const chatContainer = document.querySelector(`.${styles.chatContainer}`);\n    chatContainer.scrollTop = chatContainer.scrollHeight;\n  };\n\n\n  return (\n    <div className={styles.chatPage}> {/* Apply the scoped class */}\n    <div>\n      <div\n        id=\"loading\"\n        style={{\n          position: 'fixed',\n          width: '100%',\n          height: '100%',\n          top: 0,\n          left: 0,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          background: '#861F41',\n          zIndex: 1000,\n        }}\n      >\n        <img src={dalleBot} id={styles.loadingImage} alt=\"loading\" />\n      </div>\n      <div id={styles.app}>\n        <div id={styles.header}>\n          <button id={styles.homeButton} onClick={handleHomeClick}>\n            <img src={homeIcon} alt=\"Home\" />\n          </button>\n          <h1 id={styles.chatHeader}>MindCraft VT Chatbot</h1>\n          <select id={styles.categorySelector} defaultValue={category}>\n            <option value=\"socialLife\">Social Life</option>\n            <option value=\"academia\">Academia</option>\n            <option value=\"wellness\">Wellness</option>\n            <option value=\"tutor\">Tutor</option>\n          </select>\n        </div>\n        <div id={styles.chatContainer} className={styles.chatContainer}>\n            {messages.map((msg, index) => (\n              <div key={index} className={`${styles.wrapper} ${msg.role === 'assistant' ? styles.ai : ''}`}>\n                <div className={styles.chat}>\n                  <div className={styles.profile}>\n                    <img src={msg.role === 'assistant' ? dalleBot : apiData?.profile || user } alt={msg.role} />\n                  </div>\n                  <div className={styles.message} id={msg.id}>{msg.content}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        <form onSubmit={handleSubmit}>\n          <textarea\n            name=\"prompt\"\n            required\n            rows=\"1\"\n            cols=\"1\"\n            placeholder=\"Ask MindCraft VT...\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n          ></textarea>\n          <button type=\"submit\" id={styles.submitButton} className={styles.submitButton}>\n            <img src={sendButton} alt=\"Send\" />\n          </button>\n        </form>\n      </div>\n    </div>\n    </div>\n  );\n};\n\nexport default ChatPage;\n"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;QACzE;MACF,KAAK,UAAU;QACb3C,MAAM,GAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmEkB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEyB,SAAU;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;QACzE;MACF,KAAK,UAAU;QACb3C,MAAM,GAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmEkB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEyB,SAAU;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;QACL;MACF,KAAK,OAAO;QACV3C,MAAM,GAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsEkB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEyB,SAAU;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;QACL;MAEF;QACE3C,MAAM,GAAG,8DAA8D;QACvE;IAAM;IAEZD,QAAQ,CAAE,YAAWF,QAAS,EAAC,EAAE;MAAEI,KAAK,EAAE;QAAED;MAAO;IAAE,CAAC,CAAC;EACzD,CAAC;EACD,MAAMiD,WAAW,GAAG,MAAM;IACxB5B,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC,CAACE,KAAK,CAACC,OAAO,GAAG,MAAM;EAC3D,CAAC;EACD,MAAM0G,cAAc,GAAG,MAAM;IAC3B,MAAMhB,aAAa,GAAG9F,QAAQ,CAAC6F,aAAa,CAAE,IAAG1H,M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"},"metadata":{},"sourceType":"module","externalDependencies":[]}